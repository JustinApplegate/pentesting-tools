#Requires -RunAsAdministrator


# Burp Suite (Web proxy)
#     Note - this can't be installed from the command line, you must download and install by hand
Start-Process "https://portswigger.net/burp/releases/professional-community-2021-12-1?requestededition=community"


# Ghidra (Reverse Engineering)
#     Note - this downloads and unzips Ghidra into the C:\Users\username\ folder, installs Java, and creates a shortcut on the desktop
iwr "https://github.com/NationalSecurityAgency/ghidra/releases/download/Ghidra_10.1.1_build/ghidra_10.1.1_PUBLIC_20211221.zip" -outfile "$HOME\Downloads\ghidra.zip"
expand-archive "$HOME\Downloads\ghidra.zip" -destination "$HOME"

# install Java
iwr "https://corretto.aws/downloads/latest/amazon-corretto-11-x64-windows-jdk.msi" -outfile "$HOME\Downloads\jdk.msi"
Start-Process "$HOME\Downloads\jdk.msi" -Argumentlist "/quiet"

# put shortcut on desktop
$TargetFile = "$HOME\ghidra_10.1.1_PUBLIC\ghidraRun.bat"
$ShortcutFile = "$env:Public\Desktop\Ghidra.lnk"
$WScriptShell = New-Object -ComObject WScript.Shell
$Shortcut = $WScriptShell.CreateShortcut($ShortcutFile)
$Shortcut.TargetPath = $TargetFile
$Shortcut.Save()


# Wireshark (Packet Analysis)
#     Note - this cannot be installed fully in silent mode (npcap won't be included)
Start-Process "https://2.na.dl.wireshark.org/win64/Wireshark-win64-3.6.1.exe"


# WHOIS (DNS Reconnaissance)
#     Note - this installs it as an executable from the Downloads directory
iwr "https://download.sysinternals.com/files/WhoIs.zip" -outfile "$HOME\Downloads\whois.zip"
expand-archive "$HOME\Downloads\whois.zip" -destination "$HOME\Downloads"


# macro_pack (Macro Payload Generator)
#     Note - this installs it as an executable from the Downloads directory
iwr "https://github.com/sevagas/macro_pack/releases/download/v2.1.0/macro_pack.exe" -outfile "$HOME\Downloads\macro_pack.exe"


# PrivescCheck (Privilege Escalation)
#     Note - this installs it as a PowerShell script from the Downloads directory
iwr "https://raw.githubusercontent.com/itm4n/PrivescCheck/master/PrivescCheck.ps1" -outfile "$HOME\Downloads\privcheck.ps1"